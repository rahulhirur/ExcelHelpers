Sub ImportJSONFolderToExcel()
    Dim folderPath As String
    Dim savePath As String
    Dim fileName As String
    Dim fileContent As String
    Dim fso As Object
    Dim jsonData As Object
    Dim excelApp As Object
    Dim excelWorkbook As Object
    Dim excelWorksheet As Object
    Dim rowIndex As Integer
    Dim colIndex As Integer
    
    ' Create a FileSystemObject
    Set fso = CreateObject("Scripting.FileSystemObject")
    
    ' Prompt the user to select a folder containing JSON files
    With Application.FileDialog(msoFileDialogFolderPicker)
        .Title = "Select Folder Containing JSON Files"
        .AllowMultiSelect = False
        If .Show = -1 Then
            folderPath = .SelectedItems(1)
        Else
            MsgBox "No folder selected. Exiting macro.", vbExclamation
            Exit Sub
        End If
    End With
    
    ' Prompt the user to select a folder to save Excel files
    With Application.FileDialog(msoFileDialogFolderPicker)
        .Title = "Select Folder to Save Excel Files"
        .AllowMultiSelect = False
        If .Show = -1 Then
            savePath = .SelectedItems(1)
        Else
            MsgBox "No folder selected. Exiting macro.", vbExclamation
            Exit Sub
        End If
    End With
    
    ' Get a list of all JSON files in the selected folder
    fileName = Dir(folderPath & "\*.json")
    
    ' Loop through each JSON file in the folder
    Do While fileName <> ""
        ' Read the contents of the JSON file
        fileContent = fso.OpenTextFile(folderPath & "\" & fileName).ReadAll
        
        ' Display the contents of the JSON file
        MsgBox fileContent, vbInformation, "Contents of " & fileName
        
        ' Parse the JSON content
        Set jsonData = JsonConverter.ParseJson(fileContent)
        
        ' Create a new Excel application and workbook
        Set excelApp = CreateObject("Excel.Application")
        Set excelWorkbook = excelApp.Workbooks.Add
        Set excelWorksheet = excelWorkbook.Sheets(1)
        
        ' Loop through each JSON object and write data to Excel
        rowIndex = 1
        For Each jsonObj In jsonData
            colIndex = 1
            For Each key In jsonObj.keys
                excelWorksheet.Cells(rowIndex, colIndex).Value = key
                excelWorksheet.Cells(rowIndex + 1, colIndex).Value = jsonObj(key)
                colIndex = colIndex + 1
            Next key
            rowIndex = rowIndex + 2
        Next jsonObj
        
        ' Save the Excel workbook
        excelWorkbook.SaveAs savePath & "\" & Replace(fileName, ".json", ".xlsx")
        
        ' Close the workbook and quit Excel
        excelWorkbook.Close False
        excelApp.Quit
        
        ' Release object refe
